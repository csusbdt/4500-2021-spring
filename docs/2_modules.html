<html>
<head>
	<link rel="shortcut icon" type="image/png" href="images/icon-192x192.png">
	<style  type="text/css">
	button {
		font-size: 1.5em;
		margin: 10px;
	}
	</style>
</head>
<body>
	<div>
		Experiment 2: modules
	</div>
	<div id="g_unstarted_div">
		<button id="g_click_to_start_button">click to start</button>
	</div>
	<div id="g_started_div">
		<button id="g_play_music_button">play</button><br>
		<button id="g_stop_music_button">stop</button><br>
		<button id="g_louder_music_button">louder</button><br>
		<button id="g_softer_music_button">softer</button><br>
		<button id="g_suspend_button">suspend audio_context</button><br>
		<button id="g_error_button">trigger error</button><br>
	</div>
	<div id="g_error_div">
	</div>
	<script type="module">
		import { 
			create_audio_context, 
			play_music, 
			stop_music, 
			set_music_volume, 
			suspend_audio_context 
		} from './2_sound.js';
		import { set_error_div, set_error_hide_div } from './2_error.js';

		const g_unstarted_div         = document.getElementById("g_unstarted_div");
		const g_started_div           = document.getElementById("g_started_div");
		const g_error_div             = document.getElementById("g_error_div");

		set_error_hide_div(g_started_div);
		set_error_div(g_error_div);

		g_unstarted_div.style.display = 'block';
		g_started_div.style.display   = 'none';
		g_error_div.style.display     = 'none';

		const g_click_to_start_button = document.getElementById("g_click_to_start_button");
		const g_play_music_button     = document.getElementById("g_play_music_button");
		const g_stop_music_button     = document.getElementById("g_stop_music_button");
		const g_louder_music_button   = document.getElementById("g_louder_music_button");
		const g_softer_music_button   = document.getElementById("g_softer_music_button");
		const g_suspend_button        = document.getElementById("g_suspend_button");
		const g_error_button          = document.getElementById("g_error_button");

		//const music_file = 'sfx/positive_click.mp3';
		const music_file = 'music/robins_and_roses.mp3';

		g_click_to_start_button.addEventListener('click', () => {
			create_audio_context();
			g_unstarted_div.style.display = 'none';
			g_started_div.style.display = 'block';
		}, { capture: true, once: true });

		g_play_music_button.addEventListener('click', () => {
			play_music(music_file);
		}, { capture: true, once: false });

		g_stop_music_button.addEventListener('click', () => {
			stop_music();
		}, { capture: true, once: false });

		g_louder_music_button.addEventListener('click', () => {
			set_music_volume(music_file, 1);
		}, { capture: true, once: false });

		g_softer_music_button.addEventListener('click', () => {
			set_music_volume(music_file, .3);
		}, { capture: true, once: false });

		g_suspend_button.addEventListener('click', () => {
			suspend_audio_context();
		}, { capture: true, once: false });

		g_error_button.addEventListener('click', () => {
			stop_music();
			play_music("no_file.mp3");
		}, { capture: true, once: false });
	</script>
</body>
</html>
