<html>
<head>
	<link rel="shortcut icon" type="image/png" href="images/icon-192x192.png">
</head>
<body>
	<div>
		Experiment 5: audio support with classes
	</div>
	<div>
		<button id="g_fetch_button">fetch</button><br>
		<button id="g_decode_button">decode</button><br>
		<button id="g_play_button">play</button><br>
		<button id="g_increase_volume_button">increase volume</button><br>
		<button id="g_stop_button">stop</button><br>
		<button id="g_release_button">release memory</button><br>
		<div id="g_messages_div"></div>
	</div>
	<script type="module">
		import './3_error.js';
		import { c_sound } from './5_sound.js';

		/*	global g_messages_div */
		window.g_message = function(...messages) {
			messages.forEach(m => g_messages_div.innerHTML += "<br>" + m);
		}

		/*	global g_fetch_button */
		/*	global g_decode_button */
		/*	global g_play_button */
		/*	global g_increase_volume_button */
		/*	global g_stop_button */
		/*	global g_release_button */
		/*	global g_message */

		const sound = new c_sound('music/robins_and_roses.mp3');

		g_fetch_button.addEventListener('click', () => {
			sound.fetch().then(() => {
				g_message("fetched");
			});
		}, { capture: true, once: false });

		g_decode_button.addEventListener('click', () => {
			sound.decode().then(() => {
				g_message("decoded");
			});
		}, { capture: true, once: false });

		g_play_button.addEventListener('click', () => {
			sound.play(.6);
			g_message("played");
		}, { capture: true, once: false });

		g_increase_volume_button.addEventListener('click', () => {
			sound.set_volume(1);
			g_message("volume set");
		}, { capture: true, once: false });

		g_stop_button.addEventListener('click', () => {
			sound.stop();
			g_message("stopped");
		}, { capture: true, once: false });

		g_release_button.addEventListener('click', () => {
			sound.release_memory();
			g_message("memory released");
		}, { capture: true, once: false });
	</script>
</body>
</html>
