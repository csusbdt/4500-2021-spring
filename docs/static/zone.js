import{insert,remove}from"/4500-2021-spring/static/utils.js";import{starts,stops,run_stop_set,run_start_set}from"/4500-2021-spring/static/mixins.js";function c_rect(t,s,i,o){this.left=t,this.top=s,this.right=i,this.bottom=o}function c_circle(t,s,i){this.x=t,this.y=s,this.r=i}function c_triangle(t,s,i,o,n,r){this.ax=t,this.ay=s,this.bx=i,this.by=o,this.cx=n,this.cy=r}c_rect.prototype.contains=function(t,s){return t>=this.left&&t<this.right&&s>=this.top&&s<this.bottom},c_circle.prototype.contains=function(t,s){return(t-this.x)*(t-this.x)+(s-this.y)*(s-this.y)<this.r*this.r},c_triangle.prototype.contains=function(t,s){const i=this.cx-this.ax,o=this.cy-this.ay,n=this.bx-this.ax,r=this.by-this.ay,e=t-this.ax,h=s-this.ay,c=i*i+o*o,p=i*n+o*r,u=i*e+o*h,_=n*n+r*r,a=n*e+r*h,y=1/(c*_-p*p),f=(_*u-p*a)*y,l=(c*a-p*u)*y;return f>=0&&l>=0&&f+l<1};export function c_zone(t,s){this.room=t,this.order=10,this.clear_zones=!0,this.shapes=new Array,this.touch_sound=s,this.starts=starts,this.stops=stops,this.run_stop_set=run_stop_set,this.run_start_set=run_start_set}c_zone.prototype.ord=function(t){return this.ord=t,this},c_zone.prototype.rect=function(t,s,i,o){return this.shapes.push(new c_rect(t,s,i,o)),this},c_zone.prototype.circle=function(t,s,i){return this.shapes.push(new c_circle(t,s,i)),this},c_zone.prototype.triangle=function(t,s,i,o,n,r){return this.shapes.push(new c_triangle(t,s,i,o,n,r)),this},c_zone.prototype.contains=function(t,s){return this.shapes.some((i=>i.contains(t,s)))},c_zone.prototype.noclear=function(){return this.clear_zones=!1,this},c_zone.prototype.touch=function(){null!==this.touch_sound&&this.touch_sound.fast_play(),this.clear_zones&&(this.room.zones.length=0),this.run_stop_set(),this.run_start_set()},c_zone.prototype.start=function(){insert(this.room.zones,this)},c_zone.prototype.stop=function(){remove(this.room.zones,this)};